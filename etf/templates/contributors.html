{% extends "base.html" %}
{% import 'macros.html' as macros with context %}

{% block content %}
  <form method="POST">{{csrf_input}}
    <fieldset class="fieldset">
      <legend>
        <h3>Contributors</h3>
      </legend>

      <label class="label" for="add-user">Add contributor</label>
      <div class="input-button-pair">
        <input class="input-button-pair-input" placeholder="Enter a contributors email..." type="email" id="add-user-email" name="add-user-email">
        <a id="add"
           hx-data="#add-user-email"
           hx-post="{{url("evaluation-contributors", args=[evaluation_id])}}"
           hx-target="#contributor-table-body"
           hx-append="innerHTML"
           class="button input-button-pair-button">Add</a>
      </div>

      <table class="contributors">
        <thead>
          <tr>
            <th class="contributor-email-header">Email</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="contributor-table-body">
        {% for c in contributors %}
          <tr>
            <td id="td-email-a-{{loop.index}}">{{c.email}}</td>
            <td>
              <a class="button"
                   id="delete-a-{{loop.index}}"
                   hx-headers='{"X-CSRFToken": "{{csrf_token}}"}'
                   hx-delete="{{url("evaluation-contributors", args=[evaluation_id, c.email])}}"
                   hx-target="#contributor-table-body"
                   hx-append="innerHTML"
                   hx-trigger="click">Remove</a>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
      {{macros.buttons(prev_url)}}
    </fieldset>
  </form>
{% endblock %}
